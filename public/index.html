<!DOCTYPE html>
<html lang="en" data-theme="light"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xqedii Bots</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" type="image/x-icon" href="/icons/ico.ico">
</head>
<body>
  <div class="loading">
    <img src="icons/logowhite.png" class="logoanim">
  </div>
  <div class="layout-container">
    <aside class="sidebar">
        <div class="inner">
            <div class="header">
                <img src="icons/logo.png" class="logo" alt="logo" />
                <h1>Xqedii Bots</h1>
            </div>
            <nav>
                <div class="menu">
                    <div class="menu-top">
                        <button type="button" class="active" data-tab="attack">
                            <span class="material-symbols-outlined">swords</span>
                            <p>Attack</p>
                        </button>
                        <button type="button" data-tab="actions">
                            <span class="material-symbols-outlined">list_alt</span>
                            <p>Actions</p>
                        </button>
                        <button type="button" data-tab="nicks">
                            <span class="material-symbols-outlined">badge</span>
                            <p>Nicknames</p>
                        </button>
                        <button type="button" data-tab="proxy">
                            <span class="material-symbols-outlined">lan</span>
                            <p>Proxy</p>
                        </button>
                        <button type="button" data-tab="captcha">
                            <span class="material-symbols-outlined">encrypted</span>
                            <p>Captcha</p>
                        </button>
                        <button type="button" data-tab="ascii">
                            <span class="material-symbols-outlined">format_paint</span>
                            <p>Ascii Art</p>
                        </button>
                        <button type="button" data-tab="listeners">
                            <span class="material-symbols-outlined">api</span>
                            <p>Listeners</p>
                        </button>
                        <button type="button" data-tab="killswitch">
                            <span class="material-symbols-outlined">explosion</span>
                            <p>Kill Switch</p>
                        </button>
                        <button type="button" data-tab="multi-actions">
                            <span class="material-symbols-outlined">checklist_rtl</span>
                            <p>Multi Actions</p>
                        </button>
                    </div>

                    <div class="menu-bottom">
                        <button type="button" id="stats-btn" data-tab="stats">
                            <span class="material-symbols-outlined">bar_chart</span>
                            <p>Stats</p>
                        </button>
                        <button type="button" id="settings-btn">
                            <span class="material-symbols-outlined">settings</span>
                            <p>Settings</p>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
    </aside>
    
    <main>
        <div id="attack" class="tab-content active">
            <div class="attack-top-row">
                <div class="attack-form-container">
                    <h2>Attack Configuration</h2>
                    <p class="page-description">Configure and launch the attack.</p>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="ip">Server IP</label>
                            <input type="text" id="ip" placeholder="example.com">
                        </div>
                        <div class="form-group">
                            <label for="amount">Amount</label>
                            <input type="number" id="amount" placeholder="20" min="1">
                        </div>
                        <div class="form-group">
                            <label for="version">Version</label>
                            <select id="version">
                                <option value="1.18.2">1.18.2</option>
                                <option value="1.8-1.21.10">1.8-1.21.10 (Velocity)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="delay">Delay</label>
                            <input type="number" id="delay" placeholder="4000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="nicks-dropdown">Nicknames</label>
                            <select id="nicks-dropdown">
                                <option value="">Loading...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="actions-dropdown">Actions</label>
                            <select id="actions-dropdown">
                                <option value="">Loading...</option>
                            </select>
                        </div>
                        <button id="start-btn" class="btn btn-primary">Start</button>
                    </div>
                </div>
                <div class="console-container">
                     <h2>Console</h2>
                     <p id="console-description" class="page-description">Information from the process.</p>
                     <div id="console" class="console-output">Waiting for connection to the server...</div>
                     <button id="open-actions-modal-btn" class="btn btn-secondary" style="margin-top: 16px; width: 100%;">Quick Actions</button>
                </div>
            </div>

            <div class="chart-container">
                <h2>Bot Status</h2>
                <p class="page-description">Information about currently connected bots.</p>
                <div class="chart-wrapper">
                    <canvas id="bots-chart"></canvas>
                </div>
            </div>
        </div>

        <div id="actions" class="tab-content">
            <div class="content-wrapper">
                <h2>Actions Manager</h2>
                <p class="page-description">Create and manage action files.</p>
                <button id="actions-add-new" class="btn btn-primary" style="grid-column: auto; margin-bottom: 24px;">Add new action list</button>
                <div class="list-editor-container">
                    <div class="item-list-container">
                        <h3>Existing lists</h3>
                        <ul id="actions-list" class="item-list"></ul>
                    </div>
                    <div id="actions-editor-container" class="item-editor-container hidden">
                        <h3>Editor</h3>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="actions-name">Actions name</label>
                            <input type="text" id="actions-name" placeholder="Enter name">
                        </div>
                        <div class="form-group full-width">
                             <label for="actions-content">Content (one action per line)</label>
                            <textarea id="actions-content" class="editor-textarea"></textarea>
                        </div>
                        <div style="margin-top: 16px;">
                            <button id="actions-save" class="btn btn-primary" style="grid-column: auto;">Save</button>
                            <button id="actions-cancel" class="btn btn-secondary" style="grid-column: auto;">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="multi-actions" class="tab-content">
            <div class="content-wrapper">
                <h2>Multi Actions Manager</h2>
                <p class="page-description">Create actions distributed among bots. Activate the switch to enable listening for the trigger.</p>
                <button id="multi-actions-add-new" class="btn btn-primary" style="grid-column: auto; margin-bottom: 24px;">Add new multi-action</button>
                <div class="list-editor-container">
                    <div class="item-list-container">
                        <h3>Existing lists</h3>
                        <ul id="multi-actions-list" class="item-list"></ul>
                    </div>
                    <div id="multi-actions-editor-container" class="item-editor-container hidden">
                        <h3>Editor</h3>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="multi-actions-name">Multi Action name</label>
                            <input type="text" id="multi-actions-name" placeholder="Enter name">
                        </div>
                        <!-- BOX DO TRIGGERA -->
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="multi-actions-trigger" style="font-weight: bold;">Trigger Text (Starts action when detected)</label>
                            <input type="text" id="multi-actions-trigger" placeholder="e.g. start_raid">
                        </div>
                        <div class="form-group full-width">
                            <label for="multi-actions-content">Content (e.g. [send "Msg"])</label>
                            <textarea id="multi-actions-content" class="editor-textarea"></textarea>
                        </div>
                        <div style="margin-top: 16px;">
                            <button id="multi-actions-save" class="btn btn-primary" style="grid-column: auto;">Save</button>
                            <button id="multi-actions-cancel" class="btn btn-secondary" style="grid-column: auto;">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="proxy" class="tab-content">
            <div class="content-wrapper">
                <h2>Proxy Manager</h2>
                <p class="page-description">Create, manage and select active proxy lists.</p>
                <button id="proxy-add-new" class="btn btn-primary" style="grid-column: auto; margin-bottom: 24px;">Add new proxy list</button>
                <div class="list-editor-container">
                    <div class="item-list-container">
                        <h3>Existing lists</h3>
                        <ul id="proxy-list" class="item-list"></ul>
                    </div>
                    <div id="proxy-editor-container" class="item-editor-container hidden">
                        <h3>Editor</h3>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="proxy-name">Proxy list name</label>
                            <input type="text" id="proxy-name" placeholder="Enter name">
                        </div>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="proxy-type">Proxy Type</label>
                            <select id="proxy-type">
                                <option value="SOCKS5">SOCKS5</option>
                                <option value="SOCKS4">SOCKS4</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label for="proxy-content">Content (one proxy per line, e.g., ip:port)</label>
                            <textarea id="proxy-content" class="editor-textarea"></textarea>
                        </div>
                        <div style="margin-top: 16px;">
                            <button id="proxy-save" class="btn btn-primary" style="grid-column: auto;">Save</button>
                            <button id="proxy-cancel" class="btn btn-secondary" style="grid-column: auto;">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="nicks" class="tab-content">
            <div class="content-wrapper">
                 <h2>Nicknames Manager</h2>
                <p class="page-description">Create and manage nickname lists.</p>
                <button id="nicks-add-new" class="btn btn-primary" style="grid-column: auto; margin-bottom: 24px;">Add new nickname list</button>
                <div class="list-editor-container">
                    <div class="item-list-container">
                        <h3>Existing lists</h3>
                        <ul id="nicks-list" class="item-list"></ul>
                    </div>
                    <div id="nicks-editor-container" class="item-editor-container hidden">
                        <h3>Editor</h3>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="nicks-type">Nick Type</label>
                            <select id="nicks-type">
                                <option value="list">Nickname List</option>
                                <option value="generator">Generator</option>
                            </select>
                        </div>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="nicks-name">Nicknames name</label>
                            <input type="text" id="nicks-name" placeholder="Enter name">
                        </div>
                        <div class="form-group full-width">
                             <label for="nicks-content" id="nicks-content-label">Content (one nickname per line)</label>
                            <textarea id="nicks-content" class="editor-textarea"></textarea>
                        </div>
                        <div style="margin-top: 16px;">
                            <button id="nicks-save" class="btn btn-primary" style="grid-column: auto;">Save</button>
                            <button id="nicks-cancel" class="btn btn-secondary" style="grid-column: auto;">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="ascii" class="tab-content">
            <div class="content-wrapper">
                 <h2>Ascii Art Manager</h2>
                <p class="page-description">Create and manage ascii art files to be sent by the bots.</p>
                <button id="ascii-add-new" class="btn btn-primary" style="grid-column: auto; margin-bottom: 24px;">Add new ascii art</button>
                <div class="list-editor-container">
                    <div class="item-list-container">
                        <h3>Existing ascii arts</h3>
                        <ul id="ascii-list" class="item-list"></ul>
                    </div>
                    <div id="ascii-editor-container" class="item-editor-container hidden">
                        <h3>Editor</h3>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="ascii-name">Ascii art name</label>
                            <input type="text" id="ascii-name" placeholder="Enter name">
                        </div>
                        <div class="form-group full-width">
                             <label for="ascii-content">Content (one line of art per line)</label>
                            <textarea id="ascii-content" class="editor-textarea"></textarea>
                        </div>
                        <div style="margin-top: 16px;">
                            <button id="ascii-save" class="btn btn-primary" style="grid-column: auto;">Save</button>
                            <button id="ascii-cancel" class="btn btn-secondary" style="grid-column: auto;">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="listeners" class="tab-content">
            <div class="content-wrapper">
                 <h2>Listeners Manager</h2>
                <p class="page-description">Add new listeners to bots.</p>
                <button id="listeners-add-new" class="btn btn-primary" style="grid-column: auto; margin-bottom: 24px;">Add new listener</button>
                <div class="list-editor-container">
                    <div class="item-list-container">
                        <h3>Existing listeners</h3>
                        <ul id="listeners-list" class="item-list"></ul>
                    </div>
                    <div id="listeners-editor-container" class="item-editor-container hidden">
                        <h3>Editor</h3>
                        <div class="form-group full-width" style="margin-bottom: 16px;">
                            <label for="listeners-name">Listeners name</label>
                            <input type="text" id="listeners-name" placeholder="Enter name">
                        </div>
                        <div class="form-group full-width">
                             <label for="listeners-content">Content (one listener function per line)</label>
                            <textarea id="listeners-content" class="editor-textarea"></textarea>
                        </div>
                        <div style="margin-top: 16px;">
                            <button id="listeners-save" class="btn btn-primary" style="grid-column: auto;">Save</button>
                            <button id="listeners-cancel" class="btn btn-secondary" style="grid-column: auto;">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="killswitch" class="tab-content">
            <div class="content-wrapper">
                <h2>Kill Switch</h2>
                <p class="page-description">Add servers to KillSwitch panel to quickly shut them down</p>
                <button id="killswitch-add-btn" class="btn btn-primary" style="margin-bottom: 24px;">Add New Server</button>
                
                <div id="killswitch-servers-container" class="killswitch-grid">
                </div>
            </div>
        </div>
            
        <div id="captcha" class="tab-content">
            <div class="content-wrapper">
                <h2>Captcha Settings</h2>
                <p class="page-description">Configure automatic (API) or manual captcha solving.</p>
                <div class="list-editor-container">
                    <div class="item-list-container" style="flex: none; width: 100%;">
                        <h3>Configuration</h3>
                        <ul id="captcha-list" class="item-list">
                            <li style="border: 1px solid var(--border-color); cursor: default; margin-top: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                                    <span>Map Captcha Method</span>
                                    <div class="toggle-group">
                                        <!-- DODANO type="button" -->
                                        <button type="button" class="toggle-btn active" id="btn-mode-manual">Manual</button>
                                        <button type="button" class="toggle-btn" id="btn-mode-api">API (AI)</button>
                                    </div>
                                </div>
                            </li>
                            <li id="fall-check-item" style="border: 1px solid var(--border-color); cursor: default;">
                                <div class="captcha-info">
                                    <div class="captcha-toggle-btn" id="fall-check-toggle"></div>
                                    <span>Fall Check</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="stats" class="tab-content">
            <div class="content-wrapper">
                <h2>System Statistics</h2>
                <p class="page-description">Real-time CPU and RAM usage of the server.</p>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <h3>CPU Usage</h3>
                        <p id="cpu-usage-text" class="stat-value">--%</p>
                        <div class="stat-chart-wrapper">
                            <canvas id="cpu-chart"></canvas>
                        </div>
                    </div>
                    <div class="stat-card">
                        <h3>RAM Usage</h3>
                        <p id="ram-usage-text" class="stat-value">-- GB / -- GB</p>
                        <div class="stat-chart-wrapper">
                            <canvas id="ram-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
  </div>
  
  <div id="actions-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Quick Actions</h2>
                <button id="modal-close-btn" class="modal-close-btn">×</button>
            </div>
            <div class="modal-scroll-area">
                <div id="modal-actions-list" class="modal-actions-list">
                </div>
            </div>
        </div>
    </div>
    
  <div id="settings-modal" class="modal-overlay">
        <div class="modal-content" id="settings-modal-main">
            <div class="modal-header">
                <h2>Settings</h2>
                <button id="settings-modal-close-btn" class="modal-close-btn">×</button>
            </div>
            <div class="settings-content">
                <div class="setting-item">
                    <p>Dark Mode</p>
                    <div class="toggle-group">
                        <button class="toggle-btn" id="dm-on-btn">On</button>
                        <button class="toggle-btn" id="dm-off-btn">Off</button>
                    </div>
                </div>

                <div class="setting-item">
                    <p>Show Notifications</p>
                    <div class="toggle-group">
                        <button class="toggle-btn" id="notif-on-btn">On</button>
                        <button class="toggle-btn" id="notif-off-btn">Off</button>
                    </div>
                </div>
                
                <div class="setting-item">
                    <p>Server Checking</p>
                    <div class="toggle-group-3">
                        <input type="radio" id="check-off" name="server-check" value="off">
                        <label for="check-off">Off</label>

                        <input type="radio" id="check-mcsrv" name="server-check" value="mcsrv" checked>
                        <label for="check-mcsrv">API</label>

                        <input type="radio" id="check-manual" name="server-check" value="manual">
                        <label for="check-manual">DNS</label>
                    </div>
                </div>
                <div class="setting-item" style="flex-direction: column; align-items: flex-start; gap: 10px;">
                    <div style="display: flex; justify-content: space-between; width: 100%; align-items: center;">
                        <p>AutoReconnect</p>
                        <div class="toggle-group">
                            <button class="toggle-btn" id="reconnect-on-btn">On</button>
                            <button class="toggle-btn" id="reconnect-off-btn">Off</button>
                        </div>
                    </div>
                    
                    <div id="reconnect-slider-container" style="width: 100%; display: flex; flex-direction: column; gap: 5px; opacity: 0.5; pointer-events: none; transition: opacity 0.3s;">
                        <div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-color-desc);">
                            <span>Delay</span>
                            <span id="reconnect-value-text">5000ms</span>
                        </div>
                        <input type="range" id="reconnect-slider" min="0" max="15000" step="100" value="5000" class="styled-slider">
                    </div>
                </div>
                <div class="setting-item">
                    <p>Advanced Settings</p>
                    <button class="btn btn-secondary" id="adv-settings-open-btn" style="padding: 5px 15px; font-size: 0.9rem;">Open</button>
                </div>
            </div>
        </div>
    </div>
  <div id="custom-modal-overlay" class="modal-overlay">
      <div class="modal-content" style="max-width: 450px;">
          <div class="modal-header">
              <h2 id="custom-modal-title"></h2>
          </div>
          <div id="custom-modal-body" class="custom-modal-body">
          </div>
          <div id="custom-modal-footer" class="custom-modal-footer">
          </div>
      </div>
  </div>
  <div id="velocity-modal" class="modal-overlay">
    <div class="modal-content">
        
        <div class="modal-header">
            <h2 id="velocity-modal-title">Checking server...</h2>
            <div id="velocity-spinner" class="spinner-loader"></div>
        </div>

        <div id="velocity-console-output" class="console-output">
        </div>

        <div class="modal-footer">
            <button id="velocity-stop-btn" class="btn btn-danger">Stop</button>
        </div>

    </div>
  </div>
    <!-- API Key Modal -->
    <div id="api-key-modal" class="modal-overlay">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header"><h2>OpenAI API Required</h2></div>
            <div style="padding: 10px 0;">
                <p style="margin-bottom: 10px;">API mode requires a valid OpenAI API Key.</p>
                <input type="password" id="api-key-input" placeholder="sk-..." class="form-control" style="width: 100%;" autocomplete="new-password" name="api_key_field_ignore">
                <p id="api-key-error" style="color: var(--error-color); font-size: 0.9em; margin-top: 5px; display: none;"></p>
            </div>
            <div class="modal-footer" style="padding-top: 15px; display: flex; justify-content: flex-end; gap: 10px;">
                <button id="api-key-cancel" class="btn btn-secondary">Cancel</button>
                <button id="api-key-save" class="btn btn-primary">Verify & Save</button>
            </div>
        </div>
    </div>

    <!-- Manual Captcha Modal -->
    <div id="captcha-solve-modal" class="modal-overlay" style="z-index: 2000;">
        <div class="modal-content" style="max-width: 350px; text-align: center;">
            <div class="modal-header">
                <h2 style="margin: 0 auto;">Solve Captcha</h2>
                <button id="captcha-close-btn" class="modal-close-btn">×</button>
            </div>
            <div style="padding: 15px 0;">
                <img id="captcha-img-display" src="" style="width: 200px; height: 200px; image-rendering: pixelated; margin-bottom: 15px; border: 2px solid #555;">
                <input type="text" id="captcha-input-code" placeholder="Enter code..." style="width: 100%; text-align: center; font-size: 1rem;" autocomplete="off">
            </div>
            <button id="captcha-submit-btn" class="btn btn-primary" style="width: 100%;">Send Answer</button>
        </div>
    </div>
<!-- Modal Ustawień Zaawansowanych (ViaProxy) -->
  <div id="adv-settings-modal" class="modal-overlay">
      <div class="modal-content">
          <div class="modal-header">
              <h2>Advanced Settings</h2>
              <button id="adv-settings-close-btn" class="modal-close-btn">×</button>
          </div>
          <div class="settings-content">
              <!-- ViaProxy Toggle -->
              <div class="setting-item">
                  <p>ViaProxy</p>
                  <div class="toggle-group">
                      <button class="toggle-btn" id="viaproxy-on-btn">On</button>
                      <button class="toggle-btn" id="viaproxy-off-btn">Off</button>
                  </div>
              </div>
              
              <!-- ViaProxy Version Slider -->
              <div id="viaproxy-slider-container" style="width: 100%; display: flex; flex-direction: column; gap: 10px; opacity: 0.5; pointer-events: none; transition: opacity 0.3s; margin-top: 10px;">
                  <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: var(--text-color-desc);">
                      <span>Target Version</span>
                      <span id="viaproxy-version-text" style="font-weight: bold; color: var(--text-color);">1.21.11</span>
                  </div>
                  <!-- Max ustawimy dynamicznie w JS na podstawie długości tablicy wersji -->
                  <input type="range" id="viaproxy-slider" min="0" max="0" step="1" value="0" class="styled-slider">
              </div>
          </div>
      </div>
  </div>

  <!-- Modal Konsoli ViaProxy (taki sam styl jak Velocity) -->
  <div id="viaproxy-console-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="viaproxy-modal-title">Starting ViaProxy...</h2>
            <div id="viaproxy-spinner" class="spinner-loader"></div>
        </div>
        <div id="viaproxy-console-output" class="console-output"></div>
        <div class="modal-footer">
            <button id="viaproxy-stop-btn" class="btn btn-danger">Stop</button>
        </div>
    </div>
  </div>
  
  <div id="toast-container" class="toast-container"></div>
  <script src="script.js"></script>
</body>
</html>